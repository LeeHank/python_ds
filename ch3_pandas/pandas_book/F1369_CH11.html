
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>第11章：時間序列分析 &#8212; My sample book</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">My sample book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to your Jupyter Book
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Numpy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../ch2_numpy/official_beginner/official_beginner.html">
   1. Beginner (Official)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Pandas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../official_getting_started/getting_started.html">
   2. Getting Started (official)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../regex.html">
   3. Regular Expression
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Matplotlib
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../ch4_matplotlib/datacamp_matplotlib_intro.html">
   4. Intro to matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ch4_matplotlib/04.00-matplotlib_intro.html">
   5. Matplotlib 簡介與常用技巧
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ch4_matplotlib/04.01-Simple-Line-Plots.html">
   6. Simple Line Plots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ch4_matplotlib/04.02-Simple-Scatter-Plots.html">
   7. Simple Scatter Plots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ch4_matplotlib/04.03-Errorbars.html">
   8. Error bars &amp; Error region
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ch4_matplotlib/04.05-Histograms-and-Density.html">
   9. Histograms and Density
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ch4_matplotlib/04.06-Legends.html">
   10. Legends
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ch4_matplotlib/04.07-Colorbars.html">
   11. Colorbars
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ch4_matplotlib/04.08-Multiple-Subplots.html">
   12. Multiple Subplots
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Seaborn
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../datacamp_seaborn/intro_seaborn.html">
   13. Introduction to Seaborn
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Clustering
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../clustering/KMeans.html">
   14. K-Means
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../clustering/GMM.html">
   15. Gaussian Mixture Model (GMM)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../clustering/HC.html">
   16. Hierarchical Clustering
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  supervised learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../datacamp_su/datacamp_su.html">
   17. Supervised Learning with scikit-learn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../statquest_trees/classification_tree.html">
   18. Classification Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../sklearn_guide/rf_permutation_imp.html">
   19. Permutation Importance vs Random Forest Feature Importance (MDI)
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/ch3_pandas/pandas_book/F1369_CH11.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fch3_pandas/pandas_book/F1369_CH11.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/ch3_pandas/pandas_book/F1369_CH11.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pythonpandas">
   11.1 了解Python和Pandas日期工具的區別
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   11.2 對時間序列切片
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   11.3 過濾包含時間資料的欄位
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datetimeindex">
   11.4 僅適用於DatetimeIndex的方法
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   11.5 依據時間區段重新分組
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   11.6 分組彙總同一時間單位的多個欄位
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   11.7 案例演練：以『星期幾』來統計犯罪率
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   11.8 使用匿名函式來分組
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#timestamp">
   11.9 使用Timestamp與另一欄位來分組
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>第11章：時間序列分析</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pythonpandas">
   11.1 了解Python和Pandas日期工具的區別
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   11.2 對時間序列切片
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   11.3 過濾包含時間資料的欄位
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datetimeindex">
   11.4 僅適用於DatetimeIndex的方法
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   11.5 依據時間區段重新分組
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   11.6 分組彙總同一時間單位的多個欄位
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   11.7 案例演練：以『星期幾』來統計犯罪率
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   11.8 使用匿名函式來分組
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#timestamp">
   11.9 使用Timestamp與另一欄位來分組
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="id1">
<h1>第11章：時間序列分析<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pythonpandas">
<h2>11.1 了解Python和Pandas日期工具的區別<a class="headerlink" href="#pythonpandas" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;max_columns&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;max_rows&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="s1">&#39;max_colwidth&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2022</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">463198</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2022</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">hour</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
                       <span class="n">microsecond</span><span class="o">=</span><span class="mi">463198</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;date is </span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>date is 2022-06-07
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;time is </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time is 12:30:19.463198
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;datetime is </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime is 2022-06-07 12:30:19.463198
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">td</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">weeks</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">hours</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                        <span class="n">minutes</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mf">6.73</span><span class="p">,</span>
                        <span class="n">milliseconds</span><span class="o">=</span><span class="mi">99</span><span class="p">,</span> <span class="n">microseconds</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">td</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.timedelta(days=19, seconds=37206, microseconds=829008)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;new date is </span><span class="si">{</span><span class="n">date</span><span class="o">+</span><span class="n">td</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>new date is 2022-06-26
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;new datetime is </span><span class="si">{</span><span class="n">dt</span><span class="o">+</span><span class="n">td</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>new datetime is 2022-06-26 22:50:26.292206
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># time + td</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2021</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">hour</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
             <span class="n">minute</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2021-12-21 05:10:08.000099&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2016/1/10&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2016-01-10 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2014-5/10&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2014-05-10 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;Jan 3, 2019 20:45.56&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2019-01-03 20:45:33&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2016-01-05T05:34:43.123456789&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2016-01-05 05:34:43.123456789&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;1970-01-01 00:00:00.000000500&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;1983-09-10 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2015-5-13&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2015-05-13 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2015-13-5&#39;</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2015-05-13 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;Start Date: Sep 30, 2017 Start Time: 1:30 pm&#39;</span><span class="p">,</span>
               <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;Start Date: %b </span><span class="si">%d</span><span class="s1">, %Y Start Time: %I:%M %p&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2017-09-30 13:30:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;2013-1-1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2013-04-11 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0   1970-01-11
1   1970-04-11
2   1972-09-27
3   1997-05-19
dtype: datetime64[ns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;12-5-2015&#39;</span><span class="p">,</span> <span class="s1">&#39;14-1-2013&#39;</span><span class="p">,</span> <span class="s1">&#39;20/12/2017&#39;</span><span class="p">,</span> <span class="s1">&#39;40/23/2017&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0   2015-05-12
1   2013-01-14
2   2017-12-20
3          NaT
dtype: datetime64[ns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s1">&#39;Aug 3 1999 3:45:56&#39;</span><span class="p">,</span> <span class="s1">&#39;10/31/2017&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;1999-08-03 03:45:56&#39;, &#39;2017-10-31 00:00:00&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;12 days 5 hours 3 minutes 123456789 nanoseconds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timedelta(&#39;12 days 05:03:00.123456&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">minutes</span><span class="o">=</span><span class="mf">7.34</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timedelta(&#39;5 days 00:07:20.400000&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timedelta(&#39;700 days 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="s1">&#39;67:15:45.454&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timedelta(&#39;2 days 19:15:45.454000&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0   00:00:10
1   00:01:40
dtype: timedelta64[ns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_strings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2 days 24 minutes 89.67 seconds&#39;</span><span class="p">,</span> <span class="s1">&#39;00:45:23.6&#39;</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">time_strings</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TimedeltaIndex([&#39;2 days 00:25:29.670000&#39;, &#39;0 days 00:45:23.600000&#39;], dtype=&#39;timedelta64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;12 days 5 hours 3 minutes&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timedelta(&#39;24 days 10:06:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1/1/2022&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;12 days 5 hours 3 minutes&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2022-01-25 10:06:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">td1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">td2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">([</span><span class="s1">&#39;3 hours&#39;</span><span class="p">,</span> <span class="s1">&#39;4 hours&#39;</span><span class="p">])</span>
<span class="n">td1</span> <span class="o">+</span> <span class="n">td2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TimedeltaIndex([&#39;03:00:10&#39;, &#39;04:01:40&#39;], dtype=&#39;timedelta64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;12 days&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;3 days&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2021-10-1 4:23:23.9&#39;</span><span class="p">)</span>
<span class="n">ts</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2021-10-01 05:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">second</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2021, 10, 1, 4, 23, 23)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span><span class="o">.</span><span class="n">dayofweek</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">dayofyear</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">daysinmonth</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4, 274, 31)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span><span class="o">.</span><span class="n">to_pydatetime</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2021, 10, 1, 4, 23, 23, 900000)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">td</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="mf">125.8723</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
<span class="n">td</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timedelta(&#39;5 days 05:52:20.280000&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">td</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timedelta(&#39;5 days 05:52:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">td</span><span class="o">.</span><span class="n">components</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Components(days=5, hours=5, minutes=52, seconds=20, milliseconds=280, microseconds=0, nanoseconds=0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">td</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>453140.28
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>11.2 對時間序列切片<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;data/crime.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;crime&#39;</span><span class="p">)</span>
<span class="n">crime</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OFFENSE_TYPE_ID           category
OFFENSE_CATEGORY_ID       category
REPORTED_DATE          datetime...
GEO_LON                    float64
GEO_LAT                    float64
NEIGHBORHOOD_ID           category
IS_CRIME                     int64
IS_TRAFFIC                   int64
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mem_cat</span> <span class="o">=</span> <span class="n">crime</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">mem_obj</span> <span class="o">=</span> <span class="p">(</span><span class="n">crime</span>
   <span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">&#39;OFFENSE_TYPE_ID&#39;</span><span class="p">:</span><span class="s1">&#39;object&#39;</span><span class="p">,</span>
            <span class="s1">&#39;OFFENSE_CATEGORY_ID&#39;</span><span class="p">:</span><span class="s1">&#39;object&#39;</span><span class="p">,</span>
           <span class="s1">&#39;NEIGHBORHOOD_ID&#39;</span><span class="p">:</span><span class="s1">&#39;object&#39;</span><span class="p">})</span> 
   <span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
   <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">mb</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">20</span>
<span class="nb">round</span><span class="p">(</span><span class="n">mem_cat</span> <span class="o">/</span> <span class="n">mb</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">mem_obj</span> <span class="o">/</span> <span class="n">mb</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(22.9, 116.2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span> <span class="o">=</span> <span class="n">crime</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">)</span>
<span class="n">crime</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2014-06-29 02:01:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-06-29 01:54:00</th>
      <td>vehicula...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2014-06-29 02:00:00</th>
      <td>disturbi...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2014-06-29 02:18:00</th>
      <td>curfew</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2014-06-29 04:17:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2017-09-13 05:48:00</th>
      <td>burglary...</td>
      <td>burglary</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-09-12 20:37:00</th>
      <td>weapon-u...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-09-12 16:32:00</th>
      <td>traf-hab...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-09-12 13:04:00</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-09-12 09:30:00</th>
      <td>theft-other</td>
      <td>larceny</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>460911 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2014-06-29 02:01:00&#39;, &#39;2014-06-29 01:54:00&#39;], dtype=&#39;datetime64[ns]&#39;, name=&#39;REPORTED_DATE&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2016-05-12 16:45:00&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-05-12 16:45:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-05-12 16:45:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-05-12 16:45:00</th>
      <td>fraud-id...</td>
      <td>white-co...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2016-05-12&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-05-12 23:51:00</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2016-05-12 18:40:00</th>
      <td>liquor-p...</td>
      <td>drug-alc...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2016-05-12 22:26:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-05-12 20:35:00</th>
      <td>theft-bi...</td>
      <td>larceny</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2016-05-12 09:39:00</th>
      <td>theft-of...</td>
      <td>auto-theft</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2016-05-12 17:55:00</th>
      <td>public-p...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2016-05-12 19:24:00</th>
      <td>threats-...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2016-05-12 22:28:00</th>
      <td>sex-aslt...</td>
      <td>sexual-a...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2016-05-12 15:59:00</th>
      <td>menacing...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2016-05-12 16:39:00</th>
      <td>assault-dv</td>
      <td>other-cr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>243 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2016-05&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8012, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2016&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(91076, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2016-05-12 03&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Dec 2015&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-12-01 00:48:00</th>
      <td>drug-coc...</td>
      <td>drug-alc...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2015-12-01 00:48:00</th>
      <td>theft-of...</td>
      <td>auto-theft</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2015-12-01 01:00:00</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2015-12-01 01:10:00</th>
      <td>traf-other</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2015-12-01 01:10:00</th>
      <td>traf-hab...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2015-12-31 23:35:00</th>
      <td>drug-coc...</td>
      <td>drug-alc...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2015-12-31 23:40:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2015-12-31 23:44:00</th>
      <td>drug-coc...</td>
      <td>drug-alc...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2015-12-31 23:45:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2015-12-31 23:50:00</th>
      <td>weapon-p...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>6907 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2016 Sep, 15&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(252, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;21st October 2014 05&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2015-3-4&#39;</span><span class="p">:</span><span class="s1">&#39;2016-1-1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-03-04 00:11:00</th>
      <td>assault-dv</td>
      <td>other-cr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2015-03-04 00:19:00</th>
      <td>assault-dv</td>
      <td>other-cr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2015-03-04 00:27:00</th>
      <td>theft-of...</td>
      <td>larceny</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2015-03-04 00:49:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2015-03-04 01:07:00</th>
      <td>burglary...</td>
      <td>burglary</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2016-01-01 23:15:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-01-01 23:16:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-01-01 23:40:00</th>
      <td>robbery-...</td>
      <td>robbery</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2016-01-01 23:45:00</th>
      <td>drug-coc...</td>
      <td>drug-alc...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2016-01-01 23:48:00</th>
      <td>drug-pos...</td>
      <td>drug-alc...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>75403 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2015-3-4 22&#39;</span><span class="p">:</span><span class="s1">&#39;2016-1-1 11:22:00&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-03-04 22:25:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2015-03-04 22:30:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2015-03-04 22:32:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2015-03-04 22:33:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2015-03-04 22:36:00</th>
      <td>theft-un...</td>
      <td>white-co...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2016-01-01 11:10:00</th>
      <td>theft-of...</td>
      <td>auto-theft</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2016-01-01 11:11:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-01-01 11:11:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-01-01 11:16:00</th>
      <td>traf-other</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2016-01-01 11:22:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>75071 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> crime.loc[&#39;2015-3-4&#39;:&#39;2016-1-1&#39;]
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.7 ms ± 723 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_sort</span> <span class="o">=</span> <span class="n">crime</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="o">%</span><span class="k">timeit</span> crime_sort.loc[&#39;2015-3-4&#39;:&#39;2016-1-1&#39;]
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.69 ms ± 427 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h2>11.3 過濾包含時間資料的欄位<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;data/crime.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;crime&#39;</span><span class="p">)</span>
<span class="n">crime</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OFFENSE_TYPE_ID           category
OFFENSE_CATEGORY_ID       category
REPORTED_DATE          datetime...
GEO_LON                    float64
GEO_LAT                    float64
NEIGHBORHOOD_ID           category
IS_CRIME                     int64
IS_TRAFFIC                   int64
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
    <span class="p">[</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span> <span class="o">==</span> <span class="s1">&#39;2016-05-12 16:45:00&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>300905</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>302354</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>302373</th>
      <td>fraud-id...</td>
      <td>white-co...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
    <span class="p">[</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span> <span class="o">==</span> <span class="s1">&#39;2016-05-12&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
    <span class="p">[</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span> <span class="o">==</span> <span class="s1">&#39;2016-05-12&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span><span class="p">[</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="s1">&#39;2016-05-12&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">&#39;2016-05-13&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>295715</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>296474</th>
      <td>liquor-p...</td>
      <td>drug-alc...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>297204</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>299383</th>
      <td>theft-bi...</td>
      <td>larceny</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>299389</th>
      <td>theft-of...</td>
      <td>auto-theft</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>358208</th>
      <td>public-p...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>358448</th>
      <td>threats-...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>363134</th>
      <td>sex-aslt...</td>
      <td>sexual-a...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>365959</th>
      <td>menacing...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>378711</th>
      <td>assault-dv</td>
      <td>other-cr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>243 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span><span class="p">[</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s1">&#39;2016-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2016-06&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8012, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span><span class="p">[</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="s1">&#39;2017&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(91076, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span><span class="p">[</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s1">&#39;2016-05-12 03&#39;</span><span class="p">,</span> <span class="s1">&#39;2016-05-12 04&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span><span class="p">[</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s1">&#39;2016 Sep, 15&#39;</span><span class="p">,</span> <span class="s1">&#39;2016 Sep, 16&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(252, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span><span class="p">[</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s1">&#39;21st October 2014 05&#39;</span><span class="p">,</span> 
                                   <span class="s1">&#39;21st October 2014 06&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span><span class="p">[</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s1">&#39;2015-3-4 &#39;</span><span class="p">,</span><span class="s1">&#39;2016-1-1 23:59:59&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(75403, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
    <span class="p">[</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span><span class="o">.</span><span class="n">between</span><span class="p">(</span>
         <span class="s1">&#39;2015-3-4 22&#39;</span><span class="p">,</span><span class="s1">&#39;2016-1-1 11:22:00&#39;</span><span class="p">)]</span>
    <span class="o">.</span><span class="n">shape</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(75071, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lmask</span> <span class="o">=</span> <span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span> <span class="o">&gt;=</span> <span class="s1">&#39;2015-3-4 22&#39;</span>
<span class="n">rmask</span> <span class="o">=</span> <span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span> <span class="o">&lt;=</span> <span class="s1">&#39;2016-1-1 11:22:00&#39;</span>
<span class="n">crime</span><span class="p">[</span><span class="n">lmask</span> <span class="o">&amp;</span> <span class="n">rmask</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(75071, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ctseries</span> <span class="o">=</span> <span class="n">crime</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> ctseries.loc[&#39;2015-3-4&#39;:&#39;2016-1-1&#39;]
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.9 ms ± 93.1 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> crime[crime.REPORTED_DATE.between(&#39;2015-3-4&#39;,&#39;2016-1-1&#39;)]
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.5 ms ± 269 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="datetimeindex">
<h2>11.4 僅適用於DatetimeIndex的方法<a class="headerlink" href="#datetimeindex" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;data/crime.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;crime&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">))</span>
<span class="nb">type</span><span class="p">(</span><span class="n">crime</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.indexes.datetimes.DatetimeIndex
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">between_time</span><span class="p">(</span><span class="s1">&#39;2:00&#39;</span><span class="p">,</span> <span class="s1">&#39;5:00&#39;</span><span class="p">,</span> <span class="n">include_end</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2014-06-29 02:01:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-06-29 02:00:00</th>
      <td>disturbi...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2014-06-29 02:18:00</th>
      <td>curfew</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2014-06-29 04:17:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2014-06-29 04:22:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2017-08-25 04:41:00</th>
      <td>theft-it...</td>
      <td>theft-fr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-09-13 04:17:00</th>
      <td>theft-of...</td>
      <td>auto-theft</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-09-13 02:21:00</th>
      <td>assault-...</td>
      <td>other-cr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-09-13 03:21:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2017-09-13 02:15:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>29078 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">crime</span><span class="o">.</span><span class="n">between_time</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">include_end</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2014-06-29 02:01:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-06-29 02:00:00</th>
      <td>disturbi...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2014-06-29 02:18:00</th>
      <td>curfew</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2014-06-29 04:17:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2014-06-29 04:22:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2017-08-25 04:41:00</th>
      <td>theft-it...</td>
      <td>theft-fr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-09-13 04:17:00</th>
      <td>theft-of...</td>
      <td>auto-theft</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-09-13 02:21:00</th>
      <td>assault-...</td>
      <td>other-cr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-09-13 03:21:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2017-09-13 02:15:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>29078 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">at_time</span><span class="p">(</span><span class="s1">&#39;5:47&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-11-26 05:47:00</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-04-09 05:47:00</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-02-19 05:47:00</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-02-16 05:47:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-02-12 05:47:00</th>
      <td>police-i...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2013-09-10 05:47:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2013-03-14 05:47:00</th>
      <td>theft-other</td>
      <td>larceny</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-10-08 05:47:00</th>
      <td>theft-it...</td>
      <td>theft-fr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2013-08-21 05:47:00</th>
      <td>theft-it...</td>
      <td>theft-fr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-08-23 05:47:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>118 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_sort</span> <span class="o">=</span> <span class="n">crime</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">crime_sort</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="n">offset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthBegin</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:16:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 00:47:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 01:35:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012-06-30 23:40:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-06-30 23:44:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-06-30 23:50:00</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-06-30 23:54:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-07-01 00:01:00</th>
      <td>robbery-...</td>
      <td>robbery</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>27489 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_sort</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthEnd</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:16:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 00:47:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 01:35:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012-06-29 23:01:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-06-29 23:11:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-06-29 23:41:00</th>
      <td>robbery-...</td>
      <td>robbery</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-06-29 23:57:00</th>
      <td>assault-...</td>
      <td>other-cr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-06-30 00:04:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>27332 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_date</span> <span class="o">=</span> <span class="n">crime_sort</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">first_date</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2012-01-02 00:06:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthBegin</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2012-07-01 00:06:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthEnd</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2012-06-30 00:06:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">step4</span> <span class="o">=</span> <span class="n">crime_sort</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthEnd</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">end_dt</span> <span class="o">=</span> <span class="n">crime_sort</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthEnd</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">step4_internal</span> <span class="o">=</span> <span class="n">crime_sort</span><span class="p">[:</span><span class="n">end_dt</span><span class="p">]</span>
<span class="n">step4</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">step4_internal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_sort</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthBegin</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:16:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 00:47:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 01:35:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012-06-30 23:40:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-06-30 23:40:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-06-30 23:44:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-06-30 23:50:00</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-06-30 23:54:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>27488 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_sort</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">&#39;2012-06&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:16:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 00:47:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 01:35:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012-06-30 23:40:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-06-30 23:40:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-06-30 23:44:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-06-30 23:50:00</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-06-30 23:54:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>27488 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_sort</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="s1">&#39;5D&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:16:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 00:47:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 01:35:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012-01-06 23:11:00</th>
      <td>theft-it...</td>
      <td>theft-fr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-06 23:23:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-06 23:30:00</th>
      <td>assault-dv</td>
      <td>other-cr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-06 23:44:00</th>
      <td>theft-of...</td>
      <td>auto-theft</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-06 23:55:00</th>
      <td>threats-...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>605 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_sort</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="s1">&#39;5B&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:16:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 00:47:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 01:35:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012-01-08 23:46:00</th>
      <td>theft-it...</td>
      <td>theft-fr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-08 23:51:00</th>
      <td>burglary...</td>
      <td>burglary</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-08 23:52:00</th>
      <td>theft-other</td>
      <td>larceny</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-09 00:04:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-09 00:05:00</th>
      <td>fraud-cr...</td>
      <td>white-co...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>879 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_sort</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="s1">&#39;7W&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:16:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 00:47:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 01:35:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012-02-18 21:57:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-02-18 22:19:00</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-02-18 22:20:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-02-18 22:44:00</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-02-18 23:27:00</th>
      <td>theft-it...</td>
      <td>theft-fr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>6708 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_sort</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="s1">&#39;3QS&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:16:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 00:47:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 01:35:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012-09-30 23:17:00</th>
      <td>drug-hal...</td>
      <td>drug-alc...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-09-30 23:29:00</th>
      <td>robbery-...</td>
      <td>robbery</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-09-30 23:29:00</th>
      <td>theft-of...</td>
      <td>auto-theft</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-09-30 23:41:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-09-30 23:43:00</th>
      <td>robbery-...</td>
      <td>robbery</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>43045 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_sort</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:06:00</th>
      <td>violatio...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-01-02 00:16:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 00:47:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-01-02 01:35:00</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012-12-30 23:13:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-12-30 23:14:00</th>
      <td>burglary...</td>
      <td>burglary</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-12-30 23:39:00</th>
      <td>theft-of...</td>
      <td>auto-theft</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2012-12-30 23:41:00</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2012-12-31 00:05:00</th>
      <td>assault-...</td>
      <td>other-cr...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>56897 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2012-1-16 13:40&#39;</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">months</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2012-02-16 13:40:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">do</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">months</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2012-1-22 03:22&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">do</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2014-06-25 11:22:10&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h2>11.5 依據時間區段重新分組<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_sort</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;data/crime.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;crime&#39;</span><span class="p">)</span> 
                <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">)</span> 
                <span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_sort</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.resample.DatetimeIndexResampler object at 0x000002962D2C4040&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime_sort</span>
    <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>REPORTED_DATE
2012-01-08     877
2012-01-15    1071
2012-01-22     991
2012-01-29     988
2012-02-05     888
              ... 
2017-09-03    1956
2017-09-10    1733
2017-09-17    1976
2017-09-24    1839
2017-10-01    1059
Freq: W-SUN, Length: 300, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">crime_sort</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">&#39;2012-1-8&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>877
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">crime_sort</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012-1-9&#39;</span><span class="p">:</span><span class="s1">&#39;2012-1-15&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1071
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime_sort</span>
    <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W-THU&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>REPORTED_DATE
2012-01-05     462
2012-01-12    1116
2012-01-19     924
2012-01-26    1061
2012-02-02     926
              ... 
2017-09-07    1803
2017-09-14    1866
2017-09-21    1926
2017-09-28    1720
2017-10-05      28
Freq: W-THU, Length: 301, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weekly_crimes</span> <span class="o">=</span> <span class="p">(</span><span class="n">crime_sort</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">))</span> 
                           <span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="n">weekly_crimes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>REPORTED_DATE
2012-01-08     877
2012-01-15    1071
2012-01-22     991
2012-01-29     988
2012-02-05     888
              ... 
2017-09-03    1956
2017-09-10    1733
2017-09-17    1976
2017-09-24    1839
2017-10-01    1059
Freq: W-SUN, Length: 300, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">crime_sort</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">attr</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">if</span> <span class="n">attr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">islower</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;agg&#39;,
 &#39;aggregate&#39;,
 &#39;apply&#39;,
 &#39;asfreq&#39;,
 &#39;ax&#39;,
 &#39;backfill&#39;,
 &#39;bfill&#39;,
 &#39;count&#39;,
 &#39;ffill&#39;,
 &#39;fillna&#39;,
 &#39;first&#39;,
 &#39;get_group&#39;,
 &#39;groups&#39;,
 &#39;indices&#39;,
 &#39;interpolate&#39;,
 &#39;last&#39;,
 &#39;max&#39;,
 &#39;mean&#39;,
 &#39;median&#39;,
 &#39;min&#39;,
 &#39;ndim&#39;,
 &#39;nearest&#39;,
 &#39;ngroups&#39;,
 &#39;nunique&#39;,
 &#39;obj&#39;,
 &#39;ohlc&#39;,
 &#39;pad&#39;,
 &#39;pipe&#39;,
 &#39;plot&#39;,
 &#39;prod&#39;,
 &#39;quantile&#39;,
 &#39;sem&#39;,
 &#39;size&#39;,
 &#39;std&#39;,
 &#39;sum&#39;,
 &#39;transform&#39;,
 &#39;var&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;data/crime.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;crime&#39;</span><span class="p">)</span>
<span class="n">weekly_crimes2</span> <span class="o">=</span> <span class="n">crime</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="n">weekly_crimes2</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">weekly_crimes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weekly_crimes_gby2</span> <span class="o">=</span> <span class="p">(</span><span class="n">crime</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">))</span>
                           <span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="n">weekly_crimes2</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">weekly_crimes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">weekly_crimes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;All Denver Crimes&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x296304e3f10&gt;
</pre></div>
</div>
<img alt="../../_images/F1369_CH11_106_1.png" src="../../_images/F1369_CH11_106_1.png" />
</div>
</div>
</div>
<div class="section" id="id5">
<h2>11.6 分組彙總同一時間單位的多個欄位<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;data/crime.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;crime&#39;</span><span class="p">)</span> 
           <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">)</span> 
           <span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="s1">&#39;IS_CRIME&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_TRAFFIC&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-03-31</th>
      <td>7882</td>
      <td>4726</td>
    </tr>
    <tr>
      <th>2012-06-30</th>
      <td>9641</td>
      <td>5255</td>
    </tr>
    <tr>
      <th>2012-09-30</th>
      <td>10566</td>
      <td>5003</td>
    </tr>
    <tr>
      <th>2012-12-31</th>
      <td>9197</td>
      <td>4802</td>
    </tr>
    <tr>
      <th>2013-03-31</th>
      <td>8730</td>
      <td>4442</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2016-09-30</th>
      <td>17427</td>
      <td>6199</td>
    </tr>
    <tr>
      <th>2016-12-31</th>
      <td>15984</td>
      <td>6094</td>
    </tr>
    <tr>
      <th>2017-03-31</th>
      <td>16426</td>
      <td>5587</td>
    </tr>
    <tr>
      <th>2017-06-30</th>
      <td>17486</td>
      <td>6148</td>
    </tr>
    <tr>
      <th>2017-09-30</th>
      <td>17990</td>
      <td>6101</td>
    </tr>
  </tbody>
</table>
<p>23 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;QS&#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="s1">&#39;IS_CRIME&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_TRAFFIC&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-01</th>
      <td>7882</td>
      <td>4726</td>
    </tr>
    <tr>
      <th>2012-04-01</th>
      <td>9641</td>
      <td>5255</td>
    </tr>
    <tr>
      <th>2012-07-01</th>
      <td>10566</td>
      <td>5003</td>
    </tr>
    <tr>
      <th>2012-10-01</th>
      <td>9197</td>
      <td>4802</td>
    </tr>
    <tr>
      <th>2013-01-01</th>
      <td>8730</td>
      <td>4442</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2016-07-01</th>
      <td>17427</td>
      <td>6199</td>
    </tr>
    <tr>
      <th>2016-10-01</th>
      <td>15984</td>
      <td>6094</td>
    </tr>
    <tr>
      <th>2017-01-01</th>
      <td>16426</td>
      <td>5587</td>
    </tr>
    <tr>
      <th>2017-04-01</th>
      <td>17486</td>
      <td>6148</td>
    </tr>
    <tr>
      <th>2017-07-01</th>
      <td>17990</td>
      <td>6101</td>
    </tr>
  </tbody>
</table>
<p>23 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
   <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2012-4-1&#39;</span><span class="p">:</span><span class="s1">&#39;2012-6-30&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;IS_CRIME&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_TRAFFIC&#39;</span><span class="p">]]</span>
   <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IS_CRIME      9641
IS_TRAFFIC    5255
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;Q&#39;</span><span class="p">))</span> 
    <span class="p">[</span><span class="s1">&#39;IS_CRIME&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_TRAFFIC&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-106-424cc8bd934f&gt;:1: FutureWarning: Indexing with multiple keys (implicitly converted to a tuple of keys) will be deprecated, use a list instead.
  (crime
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-03-31</th>
      <td>7882</td>
      <td>4726</td>
    </tr>
    <tr>
      <th>2012-06-30</th>
      <td>9641</td>
      <td>5255</td>
    </tr>
    <tr>
      <th>2012-09-30</th>
      <td>10566</td>
      <td>5003</td>
    </tr>
    <tr>
      <th>2012-12-31</th>
      <td>9197</td>
      <td>4802</td>
    </tr>
    <tr>
      <th>2013-03-31</th>
      <td>8730</td>
      <td>4442</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2016-09-30</th>
      <td>17427</td>
      <td>6199</td>
    </tr>
    <tr>
      <th>2016-12-31</th>
      <td>15984</td>
      <td>6094</td>
    </tr>
    <tr>
      <th>2017-03-31</th>
      <td>16426</td>
      <td>5587</td>
    </tr>
    <tr>
      <th>2017-06-30</th>
      <td>17486</td>
      <td>6148</td>
    </tr>
    <tr>
      <th>2017-09-30</th>
      <td>17990</td>
      <td>6101</td>
    </tr>
  </tbody>
</table>
<p>23 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;Q&#39;</span><span class="p">))</span> 
    <span class="p">[</span><span class="s1">&#39;IS_CRIME&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_TRAFFIC&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgrey&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Denver Crimes and Traffic Accidents&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-107-18cce8879a55&gt;:2: FutureWarning: Indexing with multiple keys (implicitly converted to a tuple of keys) will be deprecated, use a list instead.
  (crime
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x29630640c40&gt;
</pre></div>
</div>
<img alt="../../_images/F1369_CH11_113_2.png" src="../../_images/F1369_CH11_113_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GEO_LON</th>
      <th>GEO_LAT</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-03-31</th>
      <td>-1.313006...</td>
      <td>496960.2...</td>
      <td>7882</td>
      <td>4726</td>
    </tr>
    <tr>
      <th>2012-06-30</th>
      <td>-1.547274...</td>
      <td>585656.7...</td>
      <td>9641</td>
      <td>5255</td>
    </tr>
    <tr>
      <th>2012-09-30</th>
      <td>-1.615835...</td>
      <td>611604.8...</td>
      <td>10566</td>
      <td>5003</td>
    </tr>
    <tr>
      <th>2012-12-31</th>
      <td>-1.458177...</td>
      <td>551923.0...</td>
      <td>9197</td>
      <td>4802</td>
    </tr>
    <tr>
      <th>2013-03-31</th>
      <td>-1.368931...</td>
      <td>518159.7...</td>
      <td>8730</td>
      <td>4442</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2016-09-30</th>
      <td>-2.459343...</td>
      <td>930926.4...</td>
      <td>17427</td>
      <td>6199</td>
    </tr>
    <tr>
      <th>2016-12-31</th>
      <td>-2.293628...</td>
      <td>868233.8...</td>
      <td>15984</td>
      <td>6094</td>
    </tr>
    <tr>
      <th>2017-03-31</th>
      <td>-2.288383...</td>
      <td>866234.2...</td>
      <td>16426</td>
      <td>5587</td>
    </tr>
    <tr>
      <th>2017-06-30</th>
      <td>-2.453857...</td>
      <td>928864.6...</td>
      <td>17486</td>
      <td>6148</td>
    </tr>
    <tr>
      <th>2017-09-30</th>
      <td>-2.508001...</td>
      <td>949396.3...</td>
      <td>17990</td>
      <td>6101</td>
    </tr>
  </tbody>
</table>
<p>23 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime_sort</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;QS-MAR&#39;</span><span class="p">)</span>
           <span class="p">[</span><span class="s1">&#39;IS_CRIME&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_TRAFFIC&#39;</span><span class="p">]</span> 
           <span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
    <tr>
      <th>REPORTED_DATE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2011-12-01</th>
      <td>5013</td>
      <td>3198</td>
    </tr>
    <tr>
      <th>2012-03-01</th>
      <td>9260</td>
      <td>4954</td>
    </tr>
    <tr>
      <th>2012-06-01</th>
      <td>10524</td>
      <td>5190</td>
    </tr>
    <tr>
      <th>2012-09-01</th>
      <td>9450</td>
      <td>4777</td>
    </tr>
    <tr>
      <th>2012-12-01</th>
      <td>9003</td>
      <td>4652</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2016-09-01</th>
      <td>16932</td>
      <td>6202</td>
    </tr>
    <tr>
      <th>2016-12-01</th>
      <td>15615</td>
      <td>5731</td>
    </tr>
    <tr>
      <th>2017-03-01</th>
      <td>17287</td>
      <td>5940</td>
    </tr>
    <tr>
      <th>2017-06-01</th>
      <td>18545</td>
      <td>6246</td>
    </tr>
    <tr>
      <th>2017-09-01</th>
      <td>5417</td>
      <td>1931</td>
    </tr>
  </tbody>
</table>
<p>24 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_begin</span> <span class="o">=</span> <span class="p">(</span><span class="n">crime</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span>
                    <span class="p">[</span><span class="s1">&#39;IS_CRIME&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_TRAFFIC&#39;</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="s1">&#39;IS_CRIME&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_TRAFFIC&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">crime_begin</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
    <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgrey&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Denver Crimes and Traffic Accidents % Increase&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x29630dcce80&gt;
</pre></div>
</div>
<img alt="../../_images/F1369_CH11_117_1.png" src="../../_images/F1369_CH11_117_1.png" />
</div>
</div>
</div>
<div class="section" id="id6">
<h2>11.7 案例演練：以『星期幾』來統計犯罪率<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;data/crime.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;crime&#39;</span><span class="p">)</span>
<span class="n">crime</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OFFENSE_TYPE_ID</th>
      <th>OFFENSE_CATEGORY_ID</th>
      <th>...</th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>traffic-...</td>
      <td>traffic-...</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>vehicula...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>disturbi...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>curfew</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>aggravat...</td>
      <td>aggravat...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>460906</th>
      <td>burglary...</td>
      <td>burglary</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>460907</th>
      <td>weapon-u...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>460908</th>
      <td>traf-hab...</td>
      <td>all-othe...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>460909</th>
      <td>criminal...</td>
      <td>public-d...</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>460910</th>
      <td>theft-other</td>
      <td>larceny</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>460911 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span> 
      <span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Monday       70024
Friday       69621
Wednesday    69538
Thursday     69287
Tuesday      68394
Saturday     58834
Sunday       55213
Name: REPORTED_DATE, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">days</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Monday&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuesday&#39;</span><span class="p">,</span> <span class="s1">&#39;Wednesday&#39;</span><span class="p">,</span> <span class="s1">&#39;Thursday&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Friday&#39;</span><span class="p">,</span> <span class="s1">&#39;Saturday&#39;</span><span class="p">,</span> <span class="s1">&#39;Sunday&#39;</span><span class="p">]</span>
<span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Denver Crimes and Traffic Accidents per Weekday&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="p">(</span><span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span> 
                       <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>
                       <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">))</span>         
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x29630eace20&gt;
</pre></div>
</div>
<img alt="../../_images/F1369_CH11_121_1.png" src="../../_images/F1369_CH11_121_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
   <span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span>
   <span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span> 
   <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
   <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">days</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Monday       70024
Tuesday      68394
Wednesday    69538
Thursday     69287
Friday       69621
Saturday     58834
Sunday       55213
Name: REPORTED_DATE, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Denver Crimes and Traffic Accidents per Year&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="p">(</span><span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> 
                       <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="p">)</span>
              
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x29630f0e5e0&gt;
</pre></div>
</div>
<img alt="../../_images/F1369_CH11_123_1.png" src="../../_images/F1369_CH11_123_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span>
              <span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)])</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year  day      
2012  Friday        8549
      Monday        8786
      Saturday      7442
      Sunday        7189
      Thursday      8440
                   ...  
2017  Saturday      8514
      Sunday        8124
      Thursday     10545
      Tuesday      10628
      Wednesday    10576
Length: 42, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span>
              <span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)])</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>day</th>
      <th>Friday</th>
      <th>Monday</th>
      <th>...</th>
      <th>Tuesday</th>
      <th>Wednesday</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012</th>
      <td>8549</td>
      <td>8786</td>
      <td>...</td>
      <td>8191</td>
      <td>8440</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>10380</td>
      <td>10627</td>
      <td>...</td>
      <td>10416</td>
      <td>10354</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>12683</td>
      <td>12813</td>
      <td>...</td>
      <td>12440</td>
      <td>12948</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>13273</td>
      <td>13452</td>
      <td>...</td>
      <td>13381</td>
      <td>13320</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>14059</td>
      <td>13708</td>
      <td>...</td>
      <td>13338</td>
      <td>13900</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>10677</td>
      <td>10638</td>
      <td>...</td>
      <td>10628</td>
      <td>10576</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
            <span class="n">day</span><span class="o">=</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">())</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="k">lambda</span> <span class="n">df_</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df_</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">df_</span><span class="o">.</span><span class="n">day</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>day</th>
      <th>Friday</th>
      <th>Monday</th>
      <th>...</th>
      <th>Tuesday</th>
      <th>Wednesday</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012</th>
      <td>8549</td>
      <td>8786</td>
      <td>...</td>
      <td>8191</td>
      <td>8440</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>10380</td>
      <td>10627</td>
      <td>...</td>
      <td>10416</td>
      <td>10354</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>12683</td>
      <td>12813</td>
      <td>...</td>
      <td>12440</td>
      <td>12948</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>13273</td>
      <td>13452</td>
      <td>...</td>
      <td>13381</td>
      <td>13320</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>14059</td>
      <td>13708</td>
      <td>...</td>
      <td>13338</td>
      <td>13900</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>10677</td>
      <td>10638</td>
      <td>...</td>
      <td>10628</td>
      <td>10576</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">criteria</span> <span class="o">=</span> <span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2017</span>
<span class="n">crime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">criteria</span><span class="p">,</span> <span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofyear</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>272
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">crime</span>
   <span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span>
   <span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofyear</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">272</span><span class="p">)</span> 
   <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">crime</span><span class="o">.</span><span class="n">REPORTED_DATE</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> 
   <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
   <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">crime_pct</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>REPORTED_DATE
2012    0.748
2013    0.725
2014    0.751
2015    0.748
2016    0.752
2017    1.000
Name: REPORTED_DATE, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime_pct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2012</span><span class="p">:</span><span class="mi">2016</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.748
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">update_2017</span><span class="p">(</span><span class="n">df_</span><span class="p">):</span>
    <span class="n">df_</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2017</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2017</span><span class="p">]</span>
                        <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="o">.</span><span class="mi">748</span><span class="p">)</span> 
                        <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df_</span>

<span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span>
              <span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)])</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">update_2017</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>day</th>
      <th>Monday</th>
      <th>Tuesday</th>
      <th>...</th>
      <th>Saturday</th>
      <th>Sunday</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012</th>
      <td>8786</td>
      <td>8191</td>
      <td>...</td>
      <td>7442</td>
      <td>7189</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>10627</td>
      <td>10416</td>
      <td>...</td>
      <td>8875</td>
      <td>8444</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>12813</td>
      <td>12440</td>
      <td>...</td>
      <td>10950</td>
      <td>10278</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>13452</td>
      <td>13381</td>
      <td>...</td>
      <td>11586</td>
      <td>10624</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>13708</td>
      <td>13338</td>
      <td>...</td>
      <td>11467</td>
      <td>10554</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>14221</td>
      <td>14208</td>
      <td>...</td>
      <td>11382</td>
      <td>10860</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">table</span> <span class="o">=</span> <span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span>
              <span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)])</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">update_2017</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>             
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x296357e9fa0&gt;
</pre></div>
</div>
<img alt="../../_images/F1369_CH11_131_1.png" src="../../_images/F1369_CH11_131_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">denver_pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/denver_pop.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">denver_pop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017</th>
      <td>705000</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>693000</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>680000</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>662000</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>647000</td>
    </tr>
    <tr>
      <th>2012</th>
      <td>634000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">den_100k</span> <span class="o">=</span> <span class="n">denver_pop</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">100_000</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">den_100k</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year
2017    7.05
2016    6.93
2015    6.80
2014    6.62
2013    6.47
2012    6.34
Name: Population, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span>
              <span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)])</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">update_2017</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>
<span class="p">)</span> <span class="o">/</span> <span class="n">den_100k</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2012</th>
      <th>2013</th>
      <th>...</th>
      <th>Tuesday</th>
      <th>Wednesday</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 13 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">den_100k</span> <span class="o">=</span> <span class="n">denver_pop</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">100_000</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">normalized</span> <span class="o">=</span> <span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span>
              <span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)])</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">update_2017</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>
    <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">den_100k</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">normalized</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>day</th>
      <th>Monday</th>
      <th>Tuesday</th>
      <th>...</th>
      <th>Saturday</th>
      <th>Sunday</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012</th>
      <td>1385</td>
      <td>1291</td>
      <td>...</td>
      <td>1173</td>
      <td>1133</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>1642</td>
      <td>1609</td>
      <td>...</td>
      <td>1371</td>
      <td>1305</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>1935</td>
      <td>1879</td>
      <td>...</td>
      <td>1654</td>
      <td>1552</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>1978</td>
      <td>1967</td>
      <td>...</td>
      <td>1703</td>
      <td>1562</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>1978</td>
      <td>1924</td>
      <td>...</td>
      <td>1654</td>
      <td>1522</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>2017</td>
      <td>2015</td>
      <td>...</td>
      <td>1614</td>
      <td>1540</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">normalized</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>               
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x2963cf50070&gt;
</pre></div>
</div>
<img alt="../../_images/F1369_CH11_136_1.png" src="../../_images/F1369_CH11_136_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">days</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Monday&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuesday&#39;</span><span class="p">,</span> <span class="s1">&#39;Wednesday&#39;</span><span class="p">,</span> <span class="s1">&#39;Thursday&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Friday&#39;</span><span class="p">,</span> <span class="s1">&#39;Saturday&#39;</span><span class="p">,</span> <span class="s1">&#39;Sunday&#39;</span><span class="p">]</span>
<span class="n">crime_type</span> <span class="o">=</span> <span class="s1">&#39;auto-theft&#39;</span>
<span class="n">normalized</span> <span class="o">=</span> <span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;OFFENSE_CATEGORY_ID == @crime_type&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span>
              <span class="n">crime</span><span class="p">[</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)])</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">update_2017</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>
    <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">den_100k</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">normalized</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>day</th>
      <th>Monday</th>
      <th>Tuesday</th>
      <th>...</th>
      <th>Saturday</th>
      <th>Sunday</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012</th>
      <td>95</td>
      <td>72</td>
      <td>...</td>
      <td>78</td>
      <td>76</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>85</td>
      <td>74</td>
      <td>...</td>
      <td>68</td>
      <td>67</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>94</td>
      <td>76</td>
      <td>...</td>
      <td>67</td>
      <td>67</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>108</td>
      <td>102</td>
      <td>...</td>
      <td>85</td>
      <td>78</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>119</td>
      <td>102</td>
      <td>...</td>
      <td>86</td>
      <td>85</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>114</td>
      <td>118</td>
      <td>...</td>
      <td>91</td>
      <td>102</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 7 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="id7">
<h2>11.8 使用匿名函式來分組<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;data/crime.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;crime&#39;</span><span class="p">)</span> 
           <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;REPORTED_DATE&#39;</span><span class="p">)</span> 
           <span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">common_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">crime</span><span class="o">.</span><span class="n">index</span><span class="p">))</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">)))</span>
<span class="p">[</span><span class="n">attr</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">common_attrs</span> <span class="k">if</span> <span class="n">attr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;_&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;tz_convert&#39;,
 &#39;freqstr&#39;,
 &#39;min&#39;,
 &#39;to_pydatetime&#39;,
 &#39;quarter&#39;,
 &#39;date&#39;,
 &#39;ceil&#39;,
 &#39;tz_localize&#39;,
 &#39;strftime&#39;,
 &#39;is_month_start&#39;,
 &#39;nanosecond&#39;,
 &#39;floor&#39;,
 &#39;week&#39;,
 &#39;is_year_end&#39;,
 &#39;is_quarter_end&#39;,
 &#39;tz&#39;,
 &#39;microsecond&#39;,
 &#39;year&#39;,
 &#39;to_period&#39;,
 &#39;day_name&#39;,
 &#39;round&#39;,
 &#39;timetz&#39;,
 &#39;is_year_start&#39;,
 &#39;normalize&#39;,
 &#39;month&#39;,
 &#39;weekday&#39;,
 &#39;is_leap_year&#39;,
 &#39;is_quarter_start&#39;,
 &#39;minute&#39;,
 &#39;max&#39;,
 &#39;weekofyear&#39;,
 &#39;daysinmonth&#39;,
 &#39;to_julian_date&#39;,
 &#39;hour&#39;,
 &#39;freq&#39;,
 &#39;day&#39;,
 &#39;resolution&#39;,
 &#39;tzinfo&#39;,
 &#39;second&#39;,
 &#39;days_in_month&#39;,
 &#39;time&#39;,
 &#39;dayofyear&#39;,
 &#39;month_name&#39;,
 &#39;dayofweek&#39;,
 &#39;is_month_end&#39;,
 &#39;to_numpy&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crime</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Monday       70024
Friday       69621
Wednesday    69538
Thursday     69287
Tuesday      68394
Saturday     58834
Sunday       55213
Name: REPORTED_DATE, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">crime</span>
   <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="k">lambda</span> <span class="n">idx</span><span class="p">:</span> <span class="n">idx</span><span class="o">.</span><span class="n">day_name</span><span class="p">())</span> 
   <span class="p">[</span><span class="s1">&#39;IS_CRIME&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_TRAFFIC&#39;</span><span class="p">]</span>
   <span class="o">.</span><span class="n">sum</span><span class="p">()</span>    
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-134-5eca81504d61&gt;:1: FutureWarning: Indexing with multiple keys (implicitly converted to a tuple of keys) will be deprecated, use a list instead.
  (crime
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IS_CRIME</th>
      <th>IS_TRAFFIC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Friday</th>
      <td>48833</td>
      <td>20814</td>
    </tr>
    <tr>
      <th>Monday</th>
      <td>52158</td>
      <td>17895</td>
    </tr>
    <tr>
      <th>Saturday</th>
      <td>43363</td>
      <td>15516</td>
    </tr>
    <tr>
      <th>Sunday</th>
      <td>42315</td>
      <td>12968</td>
    </tr>
    <tr>
      <th>Thursday</th>
      <td>49470</td>
      <td>19845</td>
    </tr>
    <tr>
      <th>Tuesday</th>
      <td>49658</td>
      <td>18755</td>
    </tr>
    <tr>
      <th>Wednesday</th>
      <td>50054</td>
      <td>19508</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">idx</span><span class="p">:</span> <span class="n">idx</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="s1">&#39;2h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">idx</span><span class="p">:</span> <span class="n">idx</span><span class="o">.</span><span class="n">year</span><span class="p">]</span>
<span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">funcs</span><span class="p">)</span> 
    <span class="p">[</span><span class="s1">&#39;IS_CRIME&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_TRAFFIC&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-135-ea31e1c300d4&gt;:2: FutureWarning: Indexing with multiple keys (implicitly converted to a tuple of keys) will be deprecated, use a list instead.
  (crime
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">IS_CRIME</th>
      <th>...</th>
      <th colspan="2" halign="left">IS_TRAFFIC</th>
    </tr>
    <tr>
      <th></th>
      <th>2012</th>
      <th>2013</th>
      <th>...</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2422</td>
      <td>4040</td>
      <td>...</td>
      <td>980</td>
      <td>782</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1888</td>
      <td>3214</td>
      <td>...</td>
      <td>718</td>
      <td>537</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1472</td>
      <td>2181</td>
      <td>...</td>
      <td>464</td>
      <td>313</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1067</td>
      <td>1365</td>
      <td>...</td>
      <td>593</td>
      <td>462</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2998</td>
      <td>3445</td>
      <td>...</td>
      <td>2372</td>
      <td>1828</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>4266</td>
      <td>5698</td>
      <td>...</td>
      <td>2763</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>16</th>
      <td>4113</td>
      <td>5889</td>
      <td>...</td>
      <td>3527</td>
      <td>2784</td>
    </tr>
    <tr>
      <th>18</th>
      <td>3660</td>
      <td>5094</td>
      <td>...</td>
      <td>3608</td>
      <td>2718</td>
    </tr>
    <tr>
      <th>20</th>
      <td>3521</td>
      <td>4895</td>
      <td>...</td>
      <td>2184</td>
      <td>1491</td>
    </tr>
    <tr>
      <th>22</th>
      <td>3078</td>
      <td>4318</td>
      <td>...</td>
      <td>1472</td>
      <td>1072</td>
    </tr>
  </tbody>
</table>
<p>12 rows × 12 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">idx</span><span class="p">:</span> <span class="n">idx</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="s1">&#39;2h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">idx</span><span class="p">:</span> <span class="n">idx</span><span class="o">.</span><span class="n">year</span><span class="p">]</span>
<span class="p">(</span><span class="n">crime</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">funcs</span><span class="p">)</span> 
    <span class="p">[</span><span class="s1">&#39;IS_CRIME&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_TRAFFIC&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
    <span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">highlight_max</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-136-e7ab4a9d510a&gt;:2: FutureWarning: Indexing with multiple keys (implicitly converted to a tuple of keys) will be deprecated, use a list instead.
  (crime
</pre></div>
</div>
<div class="output text_html"><style  type="text/css" >
    #T_21065424_428f_11ec_aeb7_74c63be20db0row6_col0 {
            background-color:  lightgrey;
        }    #T_21065424_428f_11ec_aeb7_74c63be20db0row8_col1 {
            background-color:  lightgrey;
        }    #T_21065424_428f_11ec_aeb7_74c63be20db0row8_col2 {
            background-color:  lightgrey;
        }    #T_21065424_428f_11ec_aeb7_74c63be20db0row8_col3 {
            background-color:  lightgrey;
        }    #T_21065424_428f_11ec_aeb7_74c63be20db0row8_col4 {
            background-color:  lightgrey;
        }    #T_21065424_428f_11ec_aeb7_74c63be20db0row8_col5 {
            background-color:  lightgrey;
        }    #T_21065424_428f_11ec_aeb7_74c63be20db0row8_col11 {
            background-color:  lightgrey;
        }    #T_21065424_428f_11ec_aeb7_74c63be20db0row9_col6 {
            background-color:  lightgrey;
        }    #T_21065424_428f_11ec_aeb7_74c63be20db0row9_col7 {
            background-color:  lightgrey;
        }    #T_21065424_428f_11ec_aeb7_74c63be20db0row9_col8 {
            background-color:  lightgrey;
        }    #T_21065424_428f_11ec_aeb7_74c63be20db0row9_col9 {
            background-color:  lightgrey;
        }    #T_21065424_428f_11ec_aeb7_74c63be20db0row9_col10 {
            background-color:  lightgrey;
        }</style><table id="T_21065424_428f_11ec_aeb7_74c63be20db0" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" colspan=6>IS_CRIME</th>        <th class="col_heading level0 col6" colspan=6>IS_TRAFFIC</th>    </tr>    <tr>        <th class="blank level1" ></th>        <th class="col_heading level1 col0" >2012</th>        <th class="col_heading level1 col1" >2013</th>        <th class="col_heading level1 col2" >2014</th>        <th class="col_heading level1 col3" >2015</th>        <th class="col_heading level1 col4" >2016</th>        <th class="col_heading level1 col5" >2017</th>        <th class="col_heading level1 col6" >2012</th>        <th class="col_heading level1 col7" >2013</th>        <th class="col_heading level1 col8" >2014</th>        <th class="col_heading level1 col9" >2015</th>        <th class="col_heading level1 col10" >2016</th>        <th class="col_heading level1 col11" >2017</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_21065424_428f_11ec_aeb7_74c63be20db0level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row0_col0" class="data row0 col0" >2422</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row0_col1" class="data row0 col1" >4040</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row0_col2" class="data row0 col2" >5649</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row0_col3" class="data row0 col3" >5649</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row0_col4" class="data row0 col4" >5377</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row0_col5" class="data row0 col5" >3811</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row0_col6" class="data row0 col6" >919</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row0_col7" class="data row0 col7" >792</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row0_col8" class="data row0 col8" >978</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row0_col9" class="data row0 col9" >1136</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row0_col10" class="data row0 col10" >980</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row0_col11" class="data row0 col11" >782</td>
            </tr>
            <tr>
                        <th id="T_21065424_428f_11ec_aeb7_74c63be20db0level0_row1" class="row_heading level0 row1" >2</th>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row1_col0" class="data row1 col0" >1888</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row1_col1" class="data row1 col1" >3214</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row1_col2" class="data row1 col2" >4245</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row1_col3" class="data row1 col3" >4050</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row1_col4" class="data row1 col4" >4091</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row1_col5" class="data row1 col5" >3041</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row1_col6" class="data row1 col6" >718</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row1_col7" class="data row1 col7" >652</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row1_col8" class="data row1 col8" >779</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row1_col9" class="data row1 col9" >773</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row1_col10" class="data row1 col10" >718</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row1_col11" class="data row1 col11" >537</td>
            </tr>
            <tr>
                        <th id="T_21065424_428f_11ec_aeb7_74c63be20db0level0_row2" class="row_heading level0 row2" >4</th>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row2_col0" class="data row2 col0" >1472</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row2_col1" class="data row2 col1" >2181</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row2_col2" class="data row2 col2" >2956</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row2_col3" class="data row2 col3" >2959</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row2_col4" class="data row2 col4" >3044</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row2_col5" class="data row2 col5" >2255</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row2_col6" class="data row2 col6" >399</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row2_col7" class="data row2 col7" >378</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row2_col8" class="data row2 col8" >424</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row2_col9" class="data row2 col9" >471</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row2_col10" class="data row2 col10" >464</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row2_col11" class="data row2 col11" >313</td>
            </tr>
            <tr>
                        <th id="T_21065424_428f_11ec_aeb7_74c63be20db0level0_row3" class="row_heading level0 row3" >6</th>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row3_col0" class="data row3 col0" >1067</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row3_col1" class="data row3 col1" >1365</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row3_col2" class="data row3 col2" >1750</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row3_col3" class="data row3 col3" >2167</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row3_col4" class="data row3 col4" >2108</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row3_col5" class="data row3 col5" >1567</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row3_col6" class="data row3 col6" >411</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row3_col7" class="data row3 col7" >399</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row3_col8" class="data row3 col8" >479</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row3_col9" class="data row3 col9" >494</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row3_col10" class="data row3 col10" >593</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row3_col11" class="data row3 col11" >462</td>
            </tr>
            <tr>
                        <th id="T_21065424_428f_11ec_aeb7_74c63be20db0level0_row4" class="row_heading level0 row4" >8</th>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row4_col0" class="data row4 col0" >2998</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row4_col1" class="data row4 col1" >3445</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row4_col2" class="data row4 col2" >3727</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row4_col3" class="data row4 col3" >4161</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row4_col4" class="data row4 col4" >4488</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row4_col5" class="data row4 col5" >3251</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row4_col6" class="data row4 col6" >1957</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row4_col7" class="data row4 col7" >1955</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row4_col8" class="data row4 col8" >2210</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row4_col9" class="data row4 col9" >2331</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row4_col10" class="data row4 col10" >2372</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row4_col11" class="data row4 col11" >1828</td>
            </tr>
            <tr>
                        <th id="T_21065424_428f_11ec_aeb7_74c63be20db0level0_row5" class="row_heading level0 row5" >10</th>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row5_col0" class="data row5 col0" >4305</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row5_col1" class="data row5 col1" >5035</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row5_col2" class="data row5 col2" >5658</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row5_col3" class="data row5 col3" >6205</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row5_col4" class="data row5 col4" >6218</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row5_col5" class="data row5 col5" >4993</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row5_col6" class="data row5 col6" >1979</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row5_col7" class="data row5 col7" >1901</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row5_col8" class="data row5 col8" >2139</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row5_col9" class="data row5 col9" >2320</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row5_col10" class="data row5 col10" >2303</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row5_col11" class="data row5 col11" >1873</td>
            </tr>
            <tr>
                        <th id="T_21065424_428f_11ec_aeb7_74c63be20db0level0_row6" class="row_heading level0 row6" >12</th>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row6_col0" class="data row6 col0" >4496</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row6_col1" class="data row6 col1" >5524</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row6_col2" class="data row6 col2" >6434</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row6_col3" class="data row6 col3" >6841</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row6_col4" class="data row6 col4" >7226</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row6_col5" class="data row6 col5" >5463</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row6_col6" class="data row6 col6" >2200</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row6_col7" class="data row6 col7" >2138</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row6_col8" class="data row6 col8" >2379</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row6_col9" class="data row6 col9" >2631</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row6_col10" class="data row6 col10" >2760</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row6_col11" class="data row6 col11" >1986</td>
            </tr>
            <tr>
                        <th id="T_21065424_428f_11ec_aeb7_74c63be20db0level0_row7" class="row_heading level0 row7" >14</th>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row7_col0" class="data row7 col0" >4266</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row7_col1" class="data row7 col1" >5698</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row7_col2" class="data row7 col2" >6708</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row7_col3" class="data row7 col3" >7218</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row7_col4" class="data row7 col4" >6896</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row7_col5" class="data row7 col5" >5396</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row7_col6" class="data row7 col6" >2241</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row7_col7" class="data row7 col7" >2245</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row7_col8" class="data row7 col8" >2630</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row7_col9" class="data row7 col9" >2840</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row7_col10" class="data row7 col10" >2763</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row7_col11" class="data row7 col11" >1990</td>
            </tr>
            <tr>
                        <th id="T_21065424_428f_11ec_aeb7_74c63be20db0level0_row8" class="row_heading level0 row8" >16</th>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row8_col0" class="data row8 col0" >4113</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row8_col1" class="data row8 col1" >5889</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row8_col2" class="data row8 col2" >7351</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row8_col3" class="data row8 col3" >7643</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row8_col4" class="data row8 col4" >7926</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row8_col5" class="data row8 col5" >6338</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row8_col6" class="data row8 col6" >2714</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row8_col7" class="data row8 col7" >2562</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row8_col8" class="data row8 col8" >3002</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row8_col9" class="data row8 col9" >3160</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row8_col10" class="data row8 col10" >3527</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row8_col11" class="data row8 col11" >2784</td>
            </tr>
            <tr>
                        <th id="T_21065424_428f_11ec_aeb7_74c63be20db0level0_row9" class="row_heading level0 row9" >18</th>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row9_col0" class="data row9 col0" >3660</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row9_col1" class="data row9 col1" >5094</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row9_col2" class="data row9 col2" >6586</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row9_col3" class="data row9 col3" >7015</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row9_col4" class="data row9 col4" >7407</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row9_col5" class="data row9 col5" >6157</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row9_col6" class="data row9 col6" >3118</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row9_col7" class="data row9 col7" >2704</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row9_col8" class="data row9 col8" >3217</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row9_col9" class="data row9 col9" >3412</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row9_col10" class="data row9 col10" >3608</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row9_col11" class="data row9 col11" >2718</td>
            </tr>
            <tr>
                        <th id="T_21065424_428f_11ec_aeb7_74c63be20db0level0_row10" class="row_heading level0 row10" >20</th>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row10_col0" class="data row10 col0" >3521</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row10_col1" class="data row10 col1" >4895</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row10_col2" class="data row10 col2" >6130</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row10_col3" class="data row10 col3" >6360</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row10_col4" class="data row10 col4" >6963</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row10_col5" class="data row10 col5" >5272</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row10_col6" class="data row10 col6" >1787</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row10_col7" class="data row10 col7" >1806</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row10_col8" class="data row10 col8" >1994</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row10_col9" class="data row10 col9" >2071</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row10_col10" class="data row10 col10" >2184</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row10_col11" class="data row10 col11" >1491</td>
            </tr>
            <tr>
                        <th id="T_21065424_428f_11ec_aeb7_74c63be20db0level0_row11" class="row_heading level0 row11" >22</th>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row11_col0" class="data row11 col0" >3078</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row11_col1" class="data row11 col1" >4318</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row11_col2" class="data row11 col2" >5496</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row11_col3" class="data row11 col3" >5626</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row11_col4" class="data row11 col4" >5637</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row11_col5" class="data row11 col5" >4358</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row11_col6" class="data row11 col6" >1343</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row11_col7" class="data row11 col7" >1330</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row11_col8" class="data row11 col8" >1532</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row11_col9" class="data row11 col9" >1671</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row11_col10" class="data row11 col10" >1472</td>
                        <td id="T_21065424_428f_11ec_aeb7_74c63be20db0row11_col11" class="data row11 col11" >1072</td>
            </tr>
    </tbody></table></div></div>
</div>
</div>
<div class="section" id="timestamp">
<h2>11.9 使用Timestamp與另一欄位來分組<a class="headerlink" href="#timestamp" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">employee</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/employee.csv&#39;</span><span class="p">,</span>
    <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;JOB_DATE&#39;</span><span class="p">,</span> <span class="s1">&#39;HIRE_DATE&#39;</span><span class="p">],</span>
    <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;HIRE_DATE&#39;</span><span class="p">)</span>
<span class="n">employee</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>UNIQUE_ID</th>
      <th>POSITION_TITLE</th>
      <th>...</th>
      <th>EMPLOYMENT_STATUS</th>
      <th>JOB_DATE</th>
    </tr>
    <tr>
      <th>HIRE_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-06-12</th>
      <td>0</td>
      <td>ASSISTAN...</td>
      <td>...</td>
      <td>Active</td>
      <td>2012-10-13</td>
    </tr>
    <tr>
      <th>2000-07-19</th>
      <td>1</td>
      <td>LIBRARY ...</td>
      <td>...</td>
      <td>Active</td>
      <td>2010-09-18</td>
    </tr>
    <tr>
      <th>2015-02-03</th>
      <td>2</td>
      <td>POLICE O...</td>
      <td>...</td>
      <td>Active</td>
      <td>2015-02-03</td>
    </tr>
    <tr>
      <th>1982-02-08</th>
      <td>3</td>
      <td>ENGINEER...</td>
      <td>...</td>
      <td>Active</td>
      <td>1991-05-25</td>
    </tr>
    <tr>
      <th>1989-06-19</th>
      <td>4</td>
      <td>ELECTRICIAN</td>
      <td>...</td>
      <td>Active</td>
      <td>1994-10-22</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2014-06-09</th>
      <td>1995</td>
      <td>POLICE O...</td>
      <td>...</td>
      <td>Active</td>
      <td>2015-06-09</td>
    </tr>
    <tr>
      <th>2003-09-02</th>
      <td>1996</td>
      <td>COMMUNIC...</td>
      <td>...</td>
      <td>Active</td>
      <td>2013-10-06</td>
    </tr>
    <tr>
      <th>2014-10-13</th>
      <td>1997</td>
      <td>POLICE O...</td>
      <td>...</td>
      <td>Active</td>
      <td>2015-10-13</td>
    </tr>
    <tr>
      <th>2009-01-20</th>
      <td>1998</td>
      <td>POLICE O...</td>
      <td>...</td>
      <td>Active</td>
      <td>2011-07-02</td>
    </tr>
    <tr>
      <th>2009-01-12</th>
      <td>1999</td>
      <td>FIRE FIG...</td>
      <td>...</td>
      <td>Active</td>
      <td>2010-07-12</td>
    </tr>
  </tbody>
</table>
<p>2000 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">employee</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;GENDER&#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="s1">&#39;BASE_SALARY&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GENDER
Female    52200.0
Male      57400.0
Name: BASE_SALARY, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">employee</span>
    <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;10AS&#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="s1">&#39;BASE_SALARY&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>    
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HIRE_DATE
1958-01-01     81200.0
1968-01-01    106500.0
1978-01-01     69600.0
1988-01-01     62300.0
1998-01-01     58200.0
2008-01-01     47200.0
Freq: 10AS-JAN, Name: BASE_SALARY, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">employee</span>
   <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;GENDER&#39;</span><span class="p">)</span>
   <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;10AS&#39;</span><span class="p">)</span>
   <span class="p">[</span><span class="s1">&#39;BASE_SALARY&#39;</span><span class="p">]</span> 
   <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
   <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GENDER  HIRE_DATE 
Female  1975-01-01     51600.0
        1985-01-01     57600.0
        1995-01-01     55500.0
        2005-01-01     51700.0
        2015-01-01     38600.0
                        ...   
Male    1968-01-01    106500.0
        1978-01-01     72300.0
        1988-01-01     64600.0
        1998-01-01     59700.0
        2008-01-01     47200.0
Name: BASE_SALARY, Length: 11, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">employee</span>
   <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;GENDER&#39;</span><span class="p">)</span>
   <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;10AS&#39;</span><span class="p">)</span>
   <span class="p">[</span><span class="s1">&#39;BASE_SALARY&#39;</span><span class="p">]</span> 
   <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
   <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
   <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;GENDER&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>GENDER</th>
      <th>Female</th>
      <th>Male</th>
    </tr>
    <tr>
      <th>HIRE_DATE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1958-01-01</th>
      <td>NaN</td>
      <td>81200.0</td>
    </tr>
    <tr>
      <th>1968-01-01</th>
      <td>NaN</td>
      <td>106500.0</td>
    </tr>
    <tr>
      <th>1975-01-01</th>
      <td>51600.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1978-01-01</th>
      <td>NaN</td>
      <td>72300.0</td>
    </tr>
    <tr>
      <th>1985-01-01</th>
      <td>57600.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1995-01-01</th>
      <td>55500.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1998-01-01</th>
      <td>NaN</td>
      <td>59700.0</td>
    </tr>
    <tr>
      <th>2005-01-01</th>
      <td>51700.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2008-01-01</th>
      <td>NaN</td>
      <td>47200.0</td>
    </tr>
    <tr>
      <th>2015-01-01</th>
      <td>38600.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>11 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">employee</span><span class="p">[</span><span class="n">employee</span><span class="p">[</span><span class="s1">&#39;GENDER&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Male&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;1958-12-29 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">employee</span><span class="p">[</span><span class="n">employee</span><span class="p">[</span><span class="s1">&#39;GENDER&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Female&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;1975-06-09 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">employee</span>
   <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;GENDER&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;10AS&#39;</span><span class="p">)])</span> 
   <span class="p">[</span><span class="s1">&#39;BASE_SALARY&#39;</span><span class="p">]</span>
   <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
   <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GENDER  HIRE_DATE 
Female  1968-01-01         NaN
        1978-01-01     57100.0
        1988-01-01     57100.0
        1998-01-01     54700.0
        2008-01-01     47300.0
                        ...   
Male    1968-01-01    106500.0
        1978-01-01     72300.0
        1988-01-01     64600.0
        1998-01-01     59700.0
        2008-01-01     47200.0
Name: BASE_SALARY, Length: 11, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">employee</span>
   <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;GENDER&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;10AS&#39;</span><span class="p">)])</span> 
   <span class="p">[</span><span class="s1">&#39;BASE_SALARY&#39;</span><span class="p">]</span>
   <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
   <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
   <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;GENDER&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>GENDER</th>
      <th>Female</th>
      <th>Male</th>
    </tr>
    <tr>
      <th>HIRE_DATE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1958-01-01</th>
      <td>NaN</td>
      <td>81200.0</td>
    </tr>
    <tr>
      <th>1968-01-01</th>
      <td>NaN</td>
      <td>106500.0</td>
    </tr>
    <tr>
      <th>1978-01-01</th>
      <td>57100.0</td>
      <td>72300.0</td>
    </tr>
    <tr>
      <th>1988-01-01</th>
      <td>57100.0</td>
      <td>64600.0</td>
    </tr>
    <tr>
      <th>1998-01-01</th>
      <td>54700.0</td>
      <td>59700.0</td>
    </tr>
    <tr>
      <th>2008-01-01</th>
      <td>47300.0</td>
      <td>47200.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sal_final</span> <span class="o">=</span> <span class="p">(</span><span class="n">employee</span>
   <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;GENDER&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;10AS&#39;</span><span class="p">)])</span> 
   <span class="p">[</span><span class="s1">&#39;BASE_SALARY&#39;</span><span class="p">]</span>
   <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
   <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
   <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;GENDER&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">sal_final</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>
<span class="n">years_right</span> <span class="o">=</span> <span class="n">years</span> <span class="o">+</span> <span class="mi">9</span>
<span class="n">sal_final</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">years</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">years_right</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">sal_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>GENDER</th>
      <th>Female</th>
      <th>Male</th>
    </tr>
    <tr>
      <th>HIRE_DATE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1958-1967</th>
      <td>NaN</td>
      <td>81200.0</td>
    </tr>
    <tr>
      <th>1968-1977</th>
      <td>NaN</td>
      <td>106500.0</td>
    </tr>
    <tr>
      <th>1978-1987</th>
      <td>57100.0</td>
      <td>72300.0</td>
    </tr>
    <tr>
      <th>1988-1997</th>
      <td>57100.0</td>
      <td>64600.0</td>
    </tr>
    <tr>
      <th>1998-2007</th>
      <td>54700.0</td>
      <td>59700.0</td>
    </tr>
    <tr>
      <th>2008-2017</th>
      <td>47300.0</td>
      <td>47200.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cuts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">employee</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cuts</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;IntervalArray&gt;
[(1958.0, 1970.0], (1970.0, 1981.0], (1981.0, 1993.0], (1993.0, 2004.0], (2004.0, 2016.0]]
Length: 5, closed: right, dtype: interval[float64]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">employee</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">cuts</span><span class="p">,</span> <span class="s1">&#39;GENDER&#39;</span><span class="p">])</span>
    <span class="p">[</span><span class="s1">&#39;BASE_SALARY&#39;</span><span class="p">]</span> 
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;GENDER&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>GENDER</th>
      <th>Female</th>
      <th>Male</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(1958.0, 1970.0]</th>
      <td>NaN</td>
      <td>85400.0</td>
    </tr>
    <tr>
      <th>(1970.0, 1981.0]</th>
      <td>54400.0</td>
      <td>72700.0</td>
    </tr>
    <tr>
      <th>(1981.0, 1993.0]</th>
      <td>55700.0</td>
      <td>69300.0</td>
    </tr>
    <tr>
      <th>(1993.0, 2004.0]</th>
      <td>56500.0</td>
      <td>62300.0</td>
    </tr>
    <tr>
      <th>(2004.0, 2016.0]</th>
      <td>49100.0</td>
      <td>49800.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ch3_pandas/pandas_book"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By The Jupyter Book Community<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>